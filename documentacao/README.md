# üèõÔ∏è SISTEMA DE GEST√ÉO - ESCOLAS IND√çGENAS E QUILOMBOLAS

## üìã Vis√£o Geral

Este sistema centraliza informa√ß√µes sobre **63 escolas ind√≠genas e quilombolas** do estado de S√£o Paulo, incluindo:
- üìç Localiza√ß√£o geogr√°fica precisa
- üöó Dados de frota por diretoria de ensino
- üìä Relat√≥rios executivos automatizados
- üåê Dashboard interativo para visualiza√ß√£o

---

## üéØ STATUS ATUAL

### ‚úÖ **SISTEMA COMPLETAMENTE SINCRONIZADO**

| Componente | Escolas | Status | √öltima Atualiza√ß√£o |
|------------|---------|--------|--------------------|
| **Dashboard Web** | 63 | ‚úÖ Ativo | 08/08/2025 |
| **Base de Dados** | 63 | ‚úÖ √çntegra | 08/08/2025 |
| **Relat√≥rio Excel** | 63 | ‚úÖ Atualizado | 08/08/2025 |
| **Relat√≥rio PDF** | 63 | ‚úÖ Gerado | 08/08/2025 |

### üìä **Estat√≠sticas Principais**
- **Total de Escolas**: 63
- **Escolas Ind√≠genas**: 43
- **Escolas Quilombolas/Assentamentos**: 20
- **Diretorias de Ensino**: 19
- **Total de Ve√≠culos**: 172
- **Metodologia de Dist√¢ncia**: Haversine (precis√£o ¬±0.1km)


## üìê Metodologia de C√°lculo de Dist√¢ncias

### üåç F√≥rmula de Haversine
Este sistema utiliza a **F√≥rmula de Haversine** para calcular as dist√¢ncias entre escolas e diretorias de ensino. Esta √© a metodologia padr√£o internacional para c√°lculos geod√©sicos precisos.

**Caracter√≠sticas da F√≥rmula de Haversine:**
- ‚úÖ **Tipo:** Dist√¢ncia geod√©sica (linha reta na superf√≠cie terrestre)
- ‚úÖ **Precis√£o:** Considera a curvatura da Terra
- ‚úÖ **Padr√£o:** Utilizada em sistemas GPS e navega√ß√£o
- ‚úÖ **Sistema:** Coordenadas WGS84 em graus decimais
- ‚úÖ **Raio Terra:** 6.371 km (raio m√©dio)

### üìä F√≥rmula Matem√°tica
```
a = sin¬≤(ŒîœÜ/2) + cos œÜ1 ‚ãÖ cos œÜ2 ‚ãÖ sin¬≤(ŒîŒª/2)
c = 2 ‚ãÖ atan2(‚àöa, ‚àö(1‚àía))
d = R ‚ãÖ c
```

Onde:
- `œÜ` = latitude
- `Œª` = longitude  
- `R` = raio da Terra (6.371 km)
- `ŒîœÜ` = diferen√ßa de latitudes
- `ŒîŒª` = diferen√ßa de longitudes

### üó∫Ô∏è Diferen√ßas com Outras Medi√ß√µes
- **Haversine (nosso sistema):** Dist√¢ncia geod√©sica "em linha reta"
- **Google Maps:** Dist√¢ncia rodovi√°ria seguindo estradas
- **Diferen√ßa esperada:** 10-20km √© normal e aceit√°vel

### ‚úÖ Valida√ß√£o
- **Total validado:** 59 escolas
- **Precis√£o:** 100% das dist√¢ncias verificadas
- **M√©todo:** Rec√°lculo autom√°tico com f√≥rmula Haversine
- **Toler√¢ncia:** ¬±0,1 km

---


## üìã Arquivos do Projeto

### Dados de Entrada

- **`ENDERECO_ESCOLAS_062025 (1).csv`** - Base de dados com todas as escolas do estado
- **`diretorias_ensino_completo.xlsx`** - Endere√ßos das 91 diretorias de ensino

### Scripts Python

- **`calcular_distancias.py`** - Script principal que calcula as dist√¢ncias
- **`converter_dados.py`** - Converte dados do Excel para formato web
- **`gerar_relatorio_excel.py`** - Gera relat√≥rio Excel sucinto e organizado
- **`gerar_relatorio_pdf.py`** - Gera relat√≥rio PDF detalhado e elegante
- **`gerar_relatorios.py`** - Menu interativo para escolher tipo de relat√≥rio

### Visualiza√ß√µes Web

- **`index.html`** - Mapa original das escolas ind√≠genas (42 escolas)
- **`distancias_escolas.html`** - Nova visualiza√ß√£o com dist√¢ncias (59 escolas)

### Arquivos Gerados

- **`distancias_escolas_diretorias.xlsx`** - Planilha com todas as dist√¢ncias calculadas
- **`diretorias_com_coordenadas.xlsx`** - Coordenadas geocodificadas das diretorias
- **`Relatorio_Completo_Escolas_Diretorias.xlsx`** - Relat√≥rio Excel abrangente (12+ colunas)
- **`Relatorio_Paisagem_Escolas_YYYYMMDD_HHMMSS.pdf`** - Relat√≥rio PDF em orienta√ß√£o paisagem

## üéØ Crit√©rios de Filtragem

O projeto identifica escolas por tipo usando o campo `TIPOESC`:

- **TIPOESC = 10**: Escolas Ind√≠genas ‚úÖ
- **TIPOESC = 36**: Escolas Quilombolas/Assentamentos ‚úÖ

> **Nota**: Centros Socioeducativos (TIPOESC = 34) foram exclu√≠dos por n√£o se enquadrarem no escopo.

## üìä Resultados Encontrados

### Estat√≠sticas Gerais

- **Total de escolas**: 59
- **Escolas Ind√≠genas**: 43
- **Escolas Quilombolas/Assentamentos**: 16
- **Dist√¢ncia m√©dia**: 50.56 km
- **Dist√¢ncia m√≠nima**: 12.63 km
- **Dist√¢ncia m√°xima**: 285.90 km

### Distribui√ß√£o por Tipo

| Tipo                      | Quantidade | Percentual |
| ------------------------- | ---------- | ---------- |
| Ind√≠genas                 | 43         | 72.9%      |
| Quilombolas/Assentamentos | 16         | 27.1%      |

## üöÄ Como Usar

### 1. Executar C√°lculo de Dist√¢ncias

```bash
python calcular_distancias.py
```

O script ir√°:

1. Filtrar escolas ind√≠genas e quilombolas/assentamentos
2. Geocodificar endere√ßos das diretorias de ensino
3. Relacionar cada escola com sua diretoria respons√°vel
4. Calcular dist√¢ncias geod√©sicas
5. Gerar arquivo Excel com resultados

### 2. Atualizar Visualiza√ß√£o Web

```bash
python converter_dados.py
```

Este script converte os dados do Excel para o formato da p√°gina web.

### 3. Gerar Relat√≥rios

```bash
python gerar_relatorios.py
```

Este script oferece um menu interativo para gerar:

- **Relat√≥rio Excel**: Sucinto e organizado em abas por tipo de escola
- **Relat√≥rio PDF**: Detalhado com gr√°ficos e layout elegante para impress√£o
- **Ambos**: Gera os dois formatos simultaneamente

### 4. Visualizar Resultados

Abra o arquivo `distancias_escolas.html` em um navegador para ver:

- Mapa interativo com escolas e diretorias
- Lista filtrada por tipo de escola
- Busca por nome ou cidade
- Visualiza√ß√£o de conex√µes escola-diretoria
- Estat√≠sticas em tempo real

## ÔøΩ Tipos de Relat√≥rios Dispon√≠veis

### 1. Relat√≥rio Excel Completo (`Relatorio_Completo_Escolas_Diretorias.xlsx`)

**Caracter√≠sticas:**

- üìä **Resumo Executivo**: Estat√≠sticas gerais e rankings
- üî¥ **Aba Escolas Ind√≠genas**: Lista completa com dados abrangentes
- üü¢ **Aba Quilombolas/Assentamentos**: Lista espec√≠fica deste tipo
- üìã **Aba Todas as Escolas**: Vis√£o consolidada
- üé® **Formata√ß√£o Profissional**: Cores por prioridade, bordas e indicadores visuais

**12+ Colunas inclu√≠das:**

```
‚Ä¢ Nome da Escola ‚úÖ
‚Ä¢ Endere√ßo Completo da Escola ‚úÖ (logradouro, n√∫mero, bairro, CEP)
‚Ä¢ Tipo de Escola (Ind√≠gena/Quilombola/Assentamento) ‚úÖ
‚Ä¢ Cidade da Escola ‚úÖ
‚Ä¢ Zona (Rural/Urbana) ‚úÖ
‚Ä¢ Diretoria Respons√°vel ‚úÖ
‚Ä¢ Endere√ßo Completo da Diretoria ‚úÖ (logradouro, n√∫mero, bairro, cidade, CEP)
‚Ä¢ Cidade da Diretoria ‚úÖ
‚Ä¢ Dist√¢ncia (km) ‚úÖ - Calculada geodesicamente
‚Ä¢ Classifica√ß√£o da Dist√¢ncia (Alta/M√©dia/Baixa) ‚úÖ
‚Ä¢ Prioridade de Aten√ß√£o (ALTA/M√âDIA/BAIXA) ‚úÖ
‚Ä¢ Coordenadas da Escola (Latitude, Longitude) ‚úÖ
‚Ä¢ Coordenadas da Diretoria (Latitude, Longitude) ‚úÖ
‚Ä¢ C√≥digo da DE ‚úÖ
‚Ä¢ Observa√ß√µes autom√°ticas ‚úÖ
```

**Exemplo completo de dados por escola:**

```
Nome: JOAO CARREIRA
Endere√ßo Escola: PRIMAVERA, SN, CAMBIRA, CEP: 16900970
Tipo: Quilombola/Assentamento
Cidade: ANDRADINA
Zona: Rural
Diretoria: Andradina
Endere√ßo Diretoria: 10a Rua R Regente Feijo, 2160, Vila Mineira, Andradina, SP, CEP: 16901908
Cidade Diretoria: Andradina
Dist√¢ncia: 16.1 km
Classifica√ß√£o: Baixa (<50km)
Prioridade: BAIXA - Adequada
Coordenadas Escola: -21,0112896, -51,46931458
Coordenadas Diretoria: -20.896505, -51.3742765
```

### 2. Relat√≥rio PDF Paisagem (`Relatorio_Paisagem_Escolas_YYYYMMDD_HHMMSS.pdf`)

**Caracter√≠sticas:**

- üìÑ **Orienta√ß√£o Paisagem**: Melhor aproveitamento do espa√ßo A4
- üìÑ **Capa Institucional**: Informa√ß√µes gerais e data do relat√≥rio
- üìà **An√°lise Estat√≠stica**: Gr√°ficos expandidos (16x6 polegadas)
- üìä **Gr√°fico Pizza**: Propor√ß√£o entre tipos de escola
- üìä **Histograma**: Distribui√ß√£o das dist√¢ncias
- üìä **Ranking Diretorias**: Top 10 com maiores dist√¢ncias m√©dias (16x8 polegadas)
- üìã **Tabelas Expandidas**: 6 colunas com mais informa√ß√µes
- üé® **Layout Elegante**: Otimizado para impress√£o panor√¢mica

**Vantagens da orienta√ß√£o paisagem:**

- ‚úÖ Tabelas mais leg√≠veis com 6 colunas
- ‚úÖ Gr√°ficos expandidos para melhor visualiza√ß√£o
- ‚úÖ Nomes completos das escolas (at√© 45 caracteres)
- ‚úÖ Mais espa√ßo para diretorias (at√© 25 caracteres)
- ‚úÖ Coluna adicional para Zona (Rural/Urbana)

## ÔøΩüóÇÔ∏è Estrutura dos Dados

### Planilha de Resultados (`distancias_escolas_diretorias.xlsx`)

| Campo               | Descri√ß√£o                           |
| ------------------- | ----------------------------------- |
| Nome_Escola         | Nome da escola                      |
| Tipo_Escola         | Ind√≠gena ou Quilombola/Assentamento |
| Cidade_Escola       | Munic√≠pio da escola                 |
| DE_Responsavel      | Diretoria de Ensino respons√°vel     |
| Zona                | Rural ou Urbana                     |
| Latitude_Escola     | Coordenada da escola                |
| Longitude_Escola    | Coordenada da escola                |
| Nome_Diretoria      | Nome da diretoria                   |
| Cidade_Diretoria    | Munic√≠pio da diretoria              |
| Latitude_Diretoria  | Coordenada da diretoria             |
| Longitude_Diretoria | Coordenada da diretoria             |
| Distancia_KM        | Dist√¢ncia calculada em quil√¥metros  |

## üìç Exemplos de Resultados

### Escolas com Menores Dist√¢ncias

1. **CRECHE ANTONIO CARLOS FERREIRA** (Birigui) - 12.63 km
2. **JOAO CARREIRA** (Andradina) - 16.1 km
3. **ALDEIA NIMUENDAJU** (Ava√≠) - 30.08 km

### Escolas com Maiores Dist√¢ncias

1. **ALDEIA KOPENOTI** (Ava√≠) - 285.90 km ‚ö†Ô∏è
2. **ALDEIA GWYRA PEPO** (S√£o Paulo) - 115.78 km
3. **ALDEIA YWY PYHAU** (Bar√£o de Antonina) - 87.43 km

> **Observa√ß√£o**: A escola "ALDEIA KOPENOTI" apresenta dist√¢ncia muito alta (285.90 km), possivelmente devido a erro nos dados de localiza√ß√£o.

## üõ†Ô∏è Depend√™ncias

```bash
pip install pandas openpyxl geopy reportlab matplotlib seaborn
```

## üìà Funcionalidades da Visualiza√ß√£o Web

### Mapa Interativo

- Marcadores diferenciados por tipo de escola
- Popup com informa√ß√µes detalhadas
- Visualiza√ß√£o de conex√µes escola-diretoria
- Zoom autom√°tico para conex√µes

### Filtros e Busca

- Filtro por tipo de escola (Todas/Ind√≠genas/Quilombolas)
- Busca por nome da escola, cidade ou diretoria
- Atualiza√ß√£o em tempo real

### Informa√ß√µes Estat√≠sticas

- Total de escolas por tipo
- Dist√¢ncia m√©dia calculada
- Indicadores visuais de dist√¢ncia (perto/m√©dio/longe)

## üé® C√≥digos de Cores

- **üî¥ Vermelho**: Escolas Ind√≠genas
- **üü¢ Verde**: Escolas Quilombolas/Assentamentos
- **üîµ Azul**: Diretorias de Ensino
- **üü° Amarelo**: Linhas de conex√£o (tempor√°rias)

## üìù Metodologia

1. **Filtragem**: Sele√ß√£o de escolas pelos c√≥digos TIPOESC corretos
2. **Geocodifica√ß√£o**: Convers√£o de endere√ßos em coordenadas geogr√°ficas
3. **Relacionamento**: Vincula√ß√£o escola-diretoria baseada no campo DE
4. **C√°lculo**: Dist√¢ncia geod√©sica usando f√≥rmula de Haversine
5. **Visualiza√ß√£o**: Interface web interativa com Leaflet.js

## ‚ö†Ô∏è Observa√ß√µes Importantes

- Algumas diretorias podem n√£o ter endere√ßos exatos, usando coordenadas da cidade
- Dist√¢ncias s√£o calculadas "em linha reta" (geod√©sica)
- Para rotas reais, seria necess√°rio usar APIs de roteamento
- Dados de coordenadas podem conter inconsist√™ncias nos arquivos originais

## üìû Pr√≥ximos Passos Sugeridos

1. **Valida√ß√£o de Dados**: Revisar coordenadas com dist√¢ncias muito altas
2. **Roteamento Real**: Integrar com API do Google Maps para rotas reais
3. **Relat√≥rios**: Gerar relat√≥rios espec√≠ficos por diretoria
4. **Dashboard**: Criar painel administrativo para acompanhamento
